# Changelog

All notable changes to this project will be documented in this file.

## [Unreleased]
- Add macOS Kanban to-do board with drag-and-drop
- Add sidebar link to the Kanban board
- Reorganize sidebar navigation with expandable sections and remove old transaction links
- Combine Currencies and FX Rates maintenance into one tabbed view
- Combine Asset Class and SubClass management into one page with sortable rows
- Add column filters, single-column sorting and double-click editing to Instruments and Positions tables
- Prompt to confirm option quantity multiplier during position import
- Show institutions ranked by AUM in new dashboard tile
- Document troubleshooting steps for missing `default.metallib` warning
- Show per-table row count comparison after restore in a modal window
- Delete Asset SubClass instantly with toast feedback and error alert when in use
- Display table details when Asset SubClass deletion fails
- Widen Restore Comparison window to display all columns without scrolling
- Confirm deletion of positions per account type with live count
- Display stale accounts grouped by age with collapsible sections
- Generate full instrument report from Database Management view
- Use latest flagged FX rates for import value calculations and report applied rates
- Store import session total value and add CLI summary report
- Show imported position values in CHF after import completes
- Persist full value reports per import session and view them from history
- Persist value reports in database after import and fix Session Details sheet closing
- Fix Import Values window closing when pressing the Close button
- Present value report in a table window after import
- Document production folder path and backups in README
- Compute value report from positions when stored data is missing
- Fix unused variable warning when computing position values
- Display consolidated crypto allocations with scrolling in Dashboard (#PR)
- Add Crypto Top 5 dashboard tile showing largest crypto holdings
- Populate import session value report modal with stored rows
- Improve Credit-Suisse parser instrument matching via Valor/ISIN with row-level logging of Valor and ISIN
- Log Valor and ISIN for each parsed Credit-Suisse row and store valor numbers
- Fix instrument report generation by locating script path correctly
- Display sub-class aggregate totals with delta validation in Allocation Targets table
- Fix compile error from variable name clash in AllocationTargetsTableView
- Shrink Data Import/Export panels and show square drag-and-drop area
- Add Import Session History tab with per-session totals
- Enable multi-institution selection in Positions view with summary totals and bulk delete
- Show total CHF value for selected institutions in Positions view
- Add ZKB CSV import parser and enable ZKB statements in Data Import/Export view
- Fix compile error when passing statement type to ImportManager
- Prompt to delete existing ZKB positions when importing statements
- Delete existing ZKB positions by name or BIC before import and log removed count
- Update ZKB deletion to use BIC `ZKBKCHZZ80A` and correct institution name
- Handle percent-valued bond prices in ZKB CSV import
- Convert percent-valued bond prices in Credit-Suisse XLS import
- Save cash account balances from Credit-Suisse statements into PositionReports
- Fix storing cash account balances when account or instrument lookup fails
- Log row numbers and failure reasons when processing cash account rows
- Fix cash account instrument lookup by currency code
- Sanitize ticker lookup so CASHCHF resolves correctly
- Allow selecting tables for transaction backups and restores with versioned filename
- Allow deleting PositionReports for a selected institution when importing ZKB statements
- Alert when an unknown instrument is encountered during import
- Fix ZKB CSV import assigning Equate Plus institution and zero quantities
- Fix type mismatch when selecting parser for statement import
- Robust ZKB instrument discovery using Valor, ISIN and ticker with logging
- Visualize target vs actual allocations with dual-ring donut chart and delta bar layout in Allocation Targets view
- Remove outdated Asset Allocation view and sidebar link
- Move Target Asset Allocation link to Key Features section
- Fix compile warnings for immutable variables in import processing
- Fix compile error in allocation charts by importing Charts framework
- Resolve build error by replacing onTapGesture with overlay gesture in donut chart
- Fix duplicate IDs in import summary logs to avoid SwiftUI warnings
- Avoid duplicate IDs in backup and import logs
- Fix compile error from private `chfFormatter` in ImportSessionHistoryView
- Add Import Session History link in sidebar navigation
- Show correct database version in startup log
- Fix seed data to include valor numbers in Instruments table
- Replace instrument seed data with Consolidated_Instruments_V8.xlsx for updated test dataset
- Integrate asset target allocation test dataset into schema.txt
- Expand seed dataset with full production reference data
- Expand PositionReports with diverse sample entries for testing
- Rename Direct Real Estate subclass to Own Real Estate and add ZKB bank accounts
- Add risk concentration dashboard tile showing top 5 groups by value
- Support asset class grouping and display CHF values in Risk Buckets tile
- Add valor number field to instruments with database and UI support
- Allow editing allocation targets in CHF or percent with per-row mode toggle
- Split Allocation Targets table into Target %/CHF columns with totals row warning
- Enforce minimum column widths in Positions table to prevent overlap
- Replace legacy target allocation editor with unified AllocationTargetsTableView
- Polish Allocation Targets table visuals and group styling
- Refine AllocationTargetsTableView with soft blue toggles and subclass backgrounds
- Improve Position form with labeled numeric fields and aligned date pickers
- Add Allocation Targets table view with hierarchical editing
- Fix compile error referencing children key path in AllocationTargetsTableView
- Refine Allocation Targets table layout with RAG badges
- Refine Position form typography and enforce minimum sheet size
- Refine AllocationTargetsTableView formatting and persistence
- Refine AllocationTargetsTableView editing and ordering behaviour
- Add sortable Target % and Actual % columns with default Actual % ordering in AllocationTargetsTableView
- Always show sort arrows and group zero-allocation rows at reduced opacity in AllocationTargetsTableView
- Add Asset Allocation view showing target vs actual with deviation slider and summary table
- Compute asset class totals from subclass values to show CHF amounts next to sliders
- Fix compile error in Asset Allocation view model by specifying dictionary types
- Fix crash from duplicate target records when viewing Asset Allocation
- Add toggle for Own Real Estate with CHF amount and persist settings
- Persist target allocation percentages to new TargetAllocation table
- Include FX History table in reference data backups
- Show info tooltip listing tables on Reference Data card
- Display popover listing reference tables when hovering info icon
- Fix unicode bullet escape in Data Import/Export status message causing build error
- Fix compile error displaying Reference Data tooltip
- Track last instrument update timestamp on PositionReports
- Track earliest instrument update timestamp on Accounts
- Test migrations for instrument update columns
- Add exchange_rates.sql script with sample FX rates for all currencies
- Fix transaction error in exchange_rates.sql script
- Embed FX rate sample data in schema seed file
- Auto-save allocation values on exit and simplify maintenance view UI
- Add ExchangeRates maintenance view for CRUD FX rate management
- Fix Asset SubClass creation failing due to missing class_id binding and show success alert on save
- Fix SQLITE_TRANSIENT compile error in ExchangeRates database helpers
- Fix compile error mapping active currencies in ExchangeRates view model
- Add "Accounts Needing Update" dashboard tile showing top 10 stale accounts
- Reverse stale accounts order so the oldest update appears first
- Fix ambiguous `fetchAccounts` call causing compilation failure in StaleAccountsViewModel
- Display Currency Maintenance and FX History links in sidebar
- Display instrument updated date in Positions view and form
- Fix instrument fetch tuple mismatch in PositionFormView
- Display earliest instrument updated date in Accounts view and forms
- Show total asset value in CHF on Positions view with refresh button
- Show total asset value in CHF on Dashboard via metric tile
- Display total asset value without decimals on the dashboard tile using Swiss thousands separator
- Format total asset value in Positions view using Swiss thousands separator
- Truncate decimals when displaying total asset value in Positions view
- Replace Load Documents with Data Import/Export view and statement log
- Enable file picker and drag-and-drop on Data Import/Export screen
- Unify drag-and-drop and file picker handling in Data Import/Export view
- Document Data Import/Export screen spec with Statement Loading Log and wireframe
- Redesign Data Import/Export view with import cards, summary bar and persistent log
- Display import progress and update log when importing Credit-Suisse statements
- Assign report date to instrument updated timestamp for Credit-Suisse imports
- Simplify Data Import/Export layout with separate status bar and persistent log
- Fix Data Import/Export layout so Select File button and log panel are visible
- Fix file importer losing selected statement type so imports run after choosing a file
- Fix Data Import/Export file picker not starting import after choosing a file
- Restore Switch Mode button in Database Management view to toggle environment
- Fix Select File button to start import by retaining chosen statement type until completion
- Restyle Statement Loading Log with padded white frame and remove extra spacer
- Add dedicated reference data backup and restore with grouped buttons
- Fix compile error from missing `rowCounts` helper
- Fix redeclaration of `counts` in BackupService
- Fix compile error when restoring reference data due to undefined `counts`
- Increase Data Import/Export canvas size and anchor Statement Loading Log at the page bottom
- Double Data Import/Export canvas to 1600Ã—1200 and keep log pinned to the bottom
- Backup reference data separately via new UI button and CLI flag
- Enforce three-zone layout on Data Import/Export screen with persistent status line
- Resolve variable scoping issue in BackupService restore function
- Restore reference data from SQL or JSON with dedicated button
- Export reference tables as SQL with CREATE and INSERT statements
- Disable foreign key checks during reference restore to avoid constraint failures
- Include Instruments and Accounts in reference data backup/restore
- Sync full reference SQL dump for tests and clarify restore instructions
- Fix permission error when restoring reference data by using security-scoped access
- Replace deprecated allowedFileTypes API in Database Management view
- Fix compile error on macOS by using `.navigation` toolbar placement
- Show row counts after each backup or restore operation in the log panel
- Allow choosing a writable backup directory with defaults in Documents
- Display per-table row counts in Backup & Restore log with header
- Prompt for save location when backing up and include mode/version in filename
- Refactor Database Management screen into subviews to resolve type-check timeout
- Update test seed data with extended asset classes and institutions
- Display per-table summary counts in log panel
- Refine Data Import/Export layout with separate Import, Status and Log panels
- Fix Full Database restore button not showing file picker
- Delete position reports for any institution directly from the Positions view
- Enable manual add, edit and delete of positions with notes field
- Offer disable or delete option for accounts with dependency check
- Include all position fields in the add/edit position form
- Fix compilation errors in Positions view after CRUD refactor
- Move database info panel from Settings to Database Management view
- Fix SQLITE_TRANSIENT not found when binding position report text fields
- Redesigned Database Management screen with card layout and detailed backup log
- Allow sorting columns and wrap long text in the Positions table
- Fix compile error from type-checking the Positions table after adding sorting
- Resolve compile timeout in Positions table by extracting column views
- Use built-in table sortOrder to fix header sorting compile errors
- Fix compile errors in positions table by inlining columns and ordering arguments correctly
- Allow optional import session when saving positions and add picker placeholders
- Fix compile error in Database Management view due to missing `databaseInfoView`
- Refactor Target Allocation list with per-class mismatch warnings and color legend
- Improve Positions table with resizable columns and notes indicator
- Fix compile error in Positions table selection binding
- Fix compile error when setting table column widths
- Add Database Management screen with backup and restore options
- Show database metadata and allow switching between production and test modes
- Fix table column width helper that broke compilation
- Fix compile error when exceeding the column limit in the positions table
- Reduce positions table to 10 columns so SwiftUI compiles
- Fix type inference issue in Positions table column closures
- Reset sub-class targets to zero when their class target is set to zero
- Fix build issue in Target Allocation view by breaking out subviews
- Resolve compile timeout in Target Allocation view by splitting left pane
- Fix compile error referencing missing AssetSubClassData type
- Correct portfolio target SQL queries to use instrument-based columns
- Added GPT shell with OpenAI function calling and JSON schema validation
- Remove duplicate Python package initializer to resolve Xcode resource error
- Extend institution seed data with contact info and default currencies
- Delete existing Credit-Suisse position reports for all Credit-Suisse accounts before importing new positions
- Replace `account_id` with `institution_id` in `ImportSessions` table
- Add CLI flags for db_tool to run phases non-interactively
- Fix incorrect parameter label when starting import sessions
- Store import sessions by institution and value date, tracking duplicate rows
- Restyle Currency Maintenance window and update title to "Currency Maintenance"
- Log mapped Asset-Unterkategorie values to AssetSubClass during Credit-Suisse import
- Populate sub-class allocation sheet with editable sliders and totals check
- Display sub-class rows correctly and allow saving with totals other than 100%
- Fix deprecated onChange warning in Target Allocation view
- Fix deprecated onChange warning in Risk Scorecard view
- Fix deprecated onChange warning in Asset Allocation view
- Persist portfolio class and sub-class targets using dictionaries
- Refactor target allocation view to edit sub-class targets inline with DisclosureGroups
- Add asset allocation variance heatmap tile to dashboard
- Fix overlapping labels and gesture issues in allocation heatmap
- Allow editing Asset Class in Asset SubClass popup
- Create cash accounts during position import and record deposits
- Extend Institutions with contact info, currency and country fields
- Add Target Allocation maintenance screen for editing portfolio targets
- Fix compile error in Target Allocation maintenance view
- Expand target allocation screen with dynamic class and sub-class editing
- Improve target allocation editor with modal sub-class panel and slider tweaks
- Fix build errors from ForEach bindings in target allocation view
- Refactor Target Allocation maintenance view to avoid type-checking timeouts
- Fix deprecated isoRegionCodes warning in Institutions view
- Add sample institutions dataset for testing
- Replace Institutions seed data with new dataset
- Rename cash account names using institution and currency codes
- Restyled Institutions maintenance window for consistent look and feel
- Retry account prompt until a account is created during position import
- Fix compile error in Institutions view due to missing empty state component
- Added Asset Class maintenance screens with create, update and delete
- Fix compile errors in Asset Class maintenance view on macOS
- Modernize Asset Class add/edit windows with standard design and logging
- Modernize Asset Class list view with search, animations and action bar
- Fix missing modernStatCard helper in Asset Classes view
- Add Credit-Suisse position import with progress logging and summary alert
- Fix quantity extraction for Credit-Suisse position import and document Excel column mapping
- Parse ticker symbol from Valor and build instrument names including institution and currency
- Default quantity to zero for "Credit-Suisse Call Account USD" when cell is blank
- Prompt for instrument details when new securities are imported
- Automatically create Credit-Suisse accounts when missing and save position reports
- Fix unused variable warning when auto-creating Credit-Suisse cash accounts
- Exclude cash instruments from performance and allocation views
- Fix missing instrument popup and save newly added instruments
- Fix instrument lookup to prompt when new securities are parsed
- Review each parsed position with editable popup before saving and fix layout constraints
- Provide instrument add dialog with Save/Ignore/Abort when new ISINs are encountered
- Restyle import popups using instrument maintenance window design
- Fix compile errors in position review and import views
- Prompt to delete existing Credit-Suisse positions before importing and show count
- Parse value date from Credit-Suisse sheets, show import details summary and improve instrument popups
- Correct account number detection from cell B6 and extend new instrument prompt with dropdowns
- Fix compile error in instrument prompt view when selecting subclass or currency
- Record Credit-Suisse import sessions and link position reports
- Eliminate QoS warnings by presenting modals synchronously
- Condense instrument popups and rename review dialog title
- Show import summary in modern styled popup
- Condense import details popup row spacing
- Default positions to "Credit-Suisse account" name
- Fix saving position reports when no import session is created
- Map Credit-Suisse categories to AssetSubClasses using documented table and treat cash
  rows as accounts instead of instruments
- Fix sub-class mapping using the defined Credit-Suisse keywords
- Search existing instruments by ticker symbol before prompting
- Use single account for all parsed positions
- Display a status alert after each position save attempt
- Allow reimporting the same file by removing unique constraint on file hash
- Prompt to create new accounts when account number is missing and retry if insertion fails
- Fix compile errors in AccountPromptView due to incorrect parameter labels
- Improve account lookup when importing positions to match numbers with spaces
  and require account name containing "Credit-Suisse" to prevent repeated prompts
- Append numbers to import session names when duplicates exist
- Fallback to account lookup by number only to use existing Credit-Suisse account
- Fix account lookup to ignore non-breaking spaces in numbers
- Retry import session creation when file_hash is unique in older databases
- Improve account search by ignoring hyphens and case
- Restrict Credit-Suisse position deletions to accounts linked to the Credit-Suisse institution
- Add Credit-Suisse institution to seed data script for tests
- Add debug logs for account lookups to help diagnose duplicates
- Strip all non-alphanumeric characters when searching account numbers so the Credit-Suisse account is detected
- Clarify that `Instruments.isin` is optional rather than mandatory
- Add Credit-Suisse Test Account with sample position reports to seed data
- Look up instruments by ISIN ignoring spaces and case so existing records are detected
- Store institution_id from the linked account when saving PositionReports and prompt before removing existing Credit-Suisse positions
- Track purchase and current price in PositionReports when importing Credit-Suisse files
- Display institution name in Positions view
- Fix Positions view table headers for quantity and price columns
- Remove OLD-BANK-007 from seed data and rename Credit-Suisse test account
- Populate purchase and current price in seed position reports
- Fix argument order when constructing PositionReportData to resolve compile error
- Enlarge the import details popup so all information is visible
- Delete Credit-Suisse position reports using institution_id so all matching entries are removed
- Use IN query when deleting by institution so duplicates with the same name are fully removed
- Ensure seed PositionReports contain only one entry per account and instrument
- Remove Credit-Suisse position reports even when old rows lack an institution_id by joining through Accounts
- Bind deletion query parameters correctly so Credit-Suisse records are removed
- Delete Credit-Suisse positions by institution_id with a single query for reliability
- Delete Credit-Suisse positions by building a dynamic IN clause for all matching institution IDs and log the IDs removed
- Automatically start Credit-Suisse position import when a file is chosen without asking to delete existing rows
- Condense import popups, enlarge windows and use smaller fonts for better readability
- Guess asset sub-class from statement categories when adding new instruments
- Fix asset sub-class dropdown defaulting to Cash when prompting for new instruments
- Document asset class concept version 2.1 with Credit-Suisse mapping
- Reduce vertical spacing in import dialogs so all fields fit without scrolling
- Display instrument currency in Positions view
- Toggle parsing checkpoints to suppress import popups and show inline summary
- Make import summary panel scrollable and arrange import view in two columns
- Fix compile errors in Target Allocation maintenance view on macOS by removing
  number-pad keyboard modifier
- Delete existing files in target directory before deploying database
- Stop DragonShield and Xcode when running the database tool
- Fix initialization of database path when detecting the active mode
- Break out Database Management view subcomponents to resolve compile timeout
- Fix compile errors in Database Management view log lists by splitting `ForEach` expressions
- Extract log lists into subviews to resolve type-check timeout
- Remove unused subviews from Database Management view to keep compile times fast
- Close edit asset class sheet when save succeeds
- Add risk-adjusted performance dashboard powered by Python analytics
- Embed risk scorecard into Portfolio Overview
- Introduce interactive Asset Dashboard grouped by asset class
- Swap ZKB and Credit-Suisse references across code and docs
- Fix duplicate reference restore function to resolve compilation error
- Fix missing SQLITE_TRANSIENT constant in reference data backup

- Replace "Custody Accounts" wording with "Accounts" across the app and docs
- Fix nested transaction error during reference data restore
- Fix missing `rowCounts` call in BackupService causing compilation failure
- Fix compile error in Database Management view due to missing `value:` label
- Add manual Refresh Instrument Timestamps button to recalculate earliest instrument dates
- Introduce configurable dashboard with tile picker and persistent layout
- Fix dashboard compilation errors by renaming MetricTile and using `any` keyword
- Fix build warnings for dashboard onChange and unused variable
- Resolve Swift compiler crash in TilePickerView by refactoring TileRegistry
- Enlarge dashboard tile picker window and add "OK" button to close
- Remove Asset Dashboard view in favor of Portfolio Overview
- Display position value columns in original currency and CHF on Positions screen
- Show Top 10 Positions by Asset Value (CHF) on Dashboard
- Add Portfolio by Currency dashboard tile with CHF-based exposure
- Allow hiding and showing columns in Positions table with persistent settings
- Add adjustable font size (7-14pt) for Positions table in column settings
- Resolve compile warnings in PositionsView and ExchangeRates helpers
- Rename "Instrument Updated" label to "Last Update" in Position form
- Remove obsolete Value Date field from Position form
- Refine Asset Allocation rows with uniform bars and vibrant deviation colors
- Increase slider marker size and align allocation bars to the right edge
- Resolve onChange deprecation warning in AllocationTargetsTableView
- Document requirements for Allocation Targets table sorting indicators and zero allocation grouping
- Document Delta % column sorting and revised zero allocation criteria in Allocation Targets spec
- Clarify macOS Table API assumptions and detail zero-allocation row handling in Allocation Targets spec
- Validate AssetSubClass target sums and highlight mismatches in AllocationTargetsTableView
- Persist AssetSubClass target edits immediately
- Display AssetSubClass actual values and calculate targets relative to parent classes
- Fix crash when closing Asset Class due to stale index paths in AllocationTargetsTableView
- Group Allocation Targets table into Active and Inactive sections with orange highlight for subclass-only activity
- Show amber background instead of red when only subclasses have targets
- Fix compile errors in AllocationTargetsTableView for totals visibility and system gray color
- Fix compile error referencing NSColor.systemGray6 by using cross-platform fieldGray color
- Organize Target Asset Allocation view into collapsible sections with status details
- Resolve Swift compile errors from invalid Unicode escapes in AllocationTargetsTableView
- Pin Allocation Targets table at top with collapsible error and chart sections
- Fix unmatched braces causing compile errors in AllocationTargetsTableView
- Simplify row background colors so valid rows are white
- Add script to export Instruments table to XLSX
- Include TargetAllocation and ExchangeRates tables in transaction backup/restore
- Fix account lookup by valor when importing cash account balances with detailed logging
- Remove ZKB position deletion prompt from Data Import/Export view; use Positions view for deletions
- Add Python script for full database backup and restore using SQLite
- Improve BackupService restore logic with atomic replace and integrity validation
- Fix compile error when calling FileManager.replaceItem during database restore
- Fix integrity check failure when validating WAL-mode backups
- Preserve backup file during restore and log pre/post row comparisons
- Show detailed Backup Summary and ensure restore logs publish on main thread
- Keep original backup file by copying to a temporary location before atomic replace
- Document python backup_restore script in README
- Close SQLite connection before file moves and update dbVersion on main thread
- Ensure published properties update on main thread and migrate onChange syntax
- Distinct colors for each risk bucket segment and matching legend
- Quick refresh icon on Accounts Needing Update dashboard tile
