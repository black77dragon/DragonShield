# Changelog

All notable changes to this project will be documented in this file.

## [Unreleased]
- Add dedicated reference data backup and restore with grouped buttons
- Backup reference data separately via new UI button and CLI flag
- Restore reference data from SQL or JSON with dedicated button
- Replace deprecated allowedFileTypes API in Database Management view
- Fix compile error on macOS by using `.navigation` toolbar placement
- Allow choosing a writable backup directory with defaults in Documents
- Prompt for save location when backing up and include mode/version in filename
- Refactor Database Management screen into subviews to resolve type-check timeout
- Delete position reports for any institution directly from the Positions view
- Enable manual add, edit and delete of positions with notes field
- Include all position fields in the add/edit position form
- Fix compilation errors in Positions view after CRUD refactor
- Move database info panel from Settings to Database Management view
- Fix SQLITE_TRANSIENT not found when binding position report text fields
- Allow sorting columns and wrap long text in the Positions table
- Fix compile error from type-checking the Positions table after adding sorting
- Resolve compile timeout in Positions table by extracting column views
- Use built-in table sortOrder to fix header sorting compile errors
- Fix compile errors in positions table by inlining columns and ordering arguments correctly
- Allow optional import session when saving positions and add picker placeholders
- Fix compile error in Database Management view due to missing `databaseInfoView`
- Refactor Target Allocation list with per-class mismatch warnings and color legend
- Improve Positions table with resizable columns and notes indicator
- Fix compile error in Positions table selection binding
- Fix compile error when setting table column widths
- Add Database Management screen with backup and restore options
- Show database metadata and allow switching between production and test modes
- Fix table column width helper that broke compilation
- Fix compile error when exceeding the column limit in the positions table
- Reduce positions table to 10 columns so SwiftUI compiles
- Fix type inference issue in Positions table column closures
- Reset sub-class targets to zero when their class target is set to zero
- Fix build issue in Target Allocation view by breaking out subviews
- Resolve compile timeout in Target Allocation view by splitting left pane
- Fix compile error referencing missing AssetSubClassData type
- Correct portfolio target SQL queries to use instrument-based columns
- Added GPT shell with OpenAI function calling and JSON schema validation
- Remove duplicate Python package initializer to resolve Xcode resource error
- Extend institution seed data with contact info and default currencies
- Delete existing Credit-Suisse position reports for all Credit-Suisse accounts before importing new positions
- Replace `account_id` with `institution_id` in `ImportSessions` table
- Add CLI flags for db_tool to run phases non-interactively
- Fix incorrect parameter label when starting import sessions
- Store import sessions by institution and value date, tracking duplicate rows
- Restyle Currency Maintenance window and update title to "Currency Maintenance"
- Log mapped Asset-Unterkategorie values to AssetSubClass during Credit-Suisse import
- Populate sub-class allocation sheet with editable sliders and totals check
- Display sub-class rows correctly and allow saving with totals other than 100%
- Fix deprecated onChange warning in Target Allocation view
- Fix deprecated onChange warning in Risk Scorecard view
- Persist portfolio class and sub-class targets using dictionaries
- Refactor target allocation view to edit sub-class targets inline with DisclosureGroups
- Add asset allocation variance heatmap tile to dashboard
- Fix overlapping labels and gesture issues in allocation heatmap
- Allow editing Asset Class in Asset SubClass popup
- Create cash accounts during position import and record deposits
- Extend Institutions with contact info, currency and country fields
- Add Target Allocation maintenance screen for editing portfolio targets
- Fix compile error in Target Allocation maintenance view
- Expand target allocation screen with dynamic class and sub-class editing
- Improve target allocation editor with modal sub-class panel and slider tweaks
- Fix build errors from ForEach bindings in target allocation view
- Refactor Target Allocation maintenance view to avoid type-checking timeouts
- Fix deprecated isoRegionCodes warning in Institutions view
- Add sample institutions dataset for testing
- Replace Institutions seed data with new dataset
- Rename cash account names using institution and currency codes
- Restyled Institutions maintenance window for consistent look and feel
- Retry account prompt until a custody account is created during position import
- Fix compile error in Institutions view due to missing empty state component
- Added Asset Class maintenance screens with create, update and delete
- Fix compile errors in Asset Class maintenance view on macOS
- Modernize Asset Class add/edit windows with standard design and logging
- Modernize Asset Class list view with search, animations and action bar
- Fix missing modernStatCard helper in Asset Classes view
- Add Credit-Suisse position import with progress logging and summary alert
- Fix quantity extraction for Credit-Suisse position import and document Excel column mapping
- Parse ticker symbol from Valor and build instrument names including institution and currency
- Default quantity to zero for "Credit-Suisse Call Account USD" when cell is blank
- Prompt for instrument details when new securities are imported
- Automatically create Credit-Suisse custody and cash accounts when missing and save position reports
- Fix unused variable warning when auto-creating Credit-Suisse cash accounts
- Exclude cash instruments from performance and allocation views
- Fix missing instrument popup and save newly added instruments
- Fix instrument lookup to prompt when new securities are parsed
- Review each parsed position with editable popup before saving and fix layout constraints
- Provide instrument add dialog with Save/Ignore/Abort when new ISINs are encountered
- Restyle import popups using instrument maintenance window design
- Fix compile errors in position review and import views
- Prompt to delete existing Credit-Suisse positions before importing and show count
- Parse value date from Credit-Suisse sheets, show import details summary and improve instrument popups
- Correct custody account number detection from cell B6 and extend new instrument prompt with dropdowns
- Fix compile error in instrument prompt view when selecting subclass or currency
- Record Credit-Suisse import sessions and link position reports
- Eliminate QoS warnings by presenting modals synchronously
- Condense instrument popups and rename review dialog title
- Show import summary in modern styled popup
- Condense import details popup row spacing
- Default custody positions to "Credit-Suisse Custody Account" name
- Fix saving position reports when no import session is created
- Map Credit-Suisse categories to AssetSubClasses using documented table and treat cash
  rows as accounts instead of instruments
- Fix sub-class mapping using the defined Credit-Suisse keywords
- Search existing instruments by ticker symbol before prompting
- Use single custody account for all parsed positions
- Display a status alert after each position save attempt
- Allow reimporting the same file by removing unique constraint on file hash
- Prompt to create new accounts when account number is missing and retry if insertion fails
- Fix compile errors in AccountPromptView due to incorrect parameter labels
- Improve account lookup when importing positions to match numbers with spaces
  and require account name containing "Credit-Suisse" to prevent repeated prompts
- Append numbers to import session names when duplicates exist
- Fallback to account lookup by number only to use existing Credit-Suisse Custody Account
- Fix account lookup to ignore non-breaking spaces in numbers
- Retry import session creation when file_hash is unique in older databases
- Improve custody account search by ignoring hyphens and case
- Restrict Credit-Suisse position deletions to accounts linked to the Credit-Suisse institution
- Add Credit-Suisse institution to seed data script for tests
- Add debug logs for custody account lookups to help diagnose duplicates
- Strip all non-alphanumeric characters when searching account numbers so the Credit-Suisse custody account is detected
- Clarify that `Instruments.isin` is optional rather than mandatory
- Add Credit-Suisse Custody Test Account with sample position reports to seed data
- Look up instruments by ISIN ignoring spaces and case so existing records are detected
- Store institution_id from the linked account when saving PositionReports and prompt before removing existing Credit-Suisse positions
- Track purchase and current price in PositionReports when importing Credit-Suisse files
- Display institution name in Positions view
- Fix Positions view table headers for quantity and price columns
- Remove OLD-BANK-007 from seed data and rename Credit-Suisse Custody test account
- Populate purchase and current price in seed position reports
- Fix argument order when constructing PositionReportData to resolve compile error
- Enlarge the import details popup so all information is visible
- Delete Credit-Suisse position reports using institution_id so all matching entries are removed
- Use IN query when deleting by institution so duplicates with the same name are fully removed
- Ensure seed PositionReports contain only one entry per account and instrument
- Remove Credit-Suisse position reports even when old rows lack an institution_id by joining through Accounts
- Bind deletion query parameters correctly so Credit-Suisse records are removed
- Delete Credit-Suisse positions by institution_id with a single query for reliability
- Delete Credit-Suisse positions by building a dynamic IN clause for all matching institution IDs and log the IDs removed
- Automatically start Credit-Suisse position import when a file is chosen without asking to delete existing rows
- Condense import popups, enlarge windows and use smaller fonts for better readability
- Guess asset sub-class from statement categories when adding new instruments
- Fix asset sub-class dropdown defaulting to Cash when prompting for new instruments
- Document asset class concept version 2.1 with Credit-Suisse mapping
- Reduce vertical spacing in import dialogs so all fields fit without scrolling
- Display instrument currency in Positions view
- Toggle parsing checkpoints to suppress import popups and show inline summary
- Make import summary panel scrollable and arrange import view in two columns
- Fix compile errors in Target Allocation maintenance view on macOS by removing
  number-pad keyboard modifier
- Delete existing files in target directory before deploying database
- Stop DragonShield and Xcode when running the database tool
- Fix initialization of database path when detecting the active mode
- Break out Database Management view subcomponents to resolve compile timeout
- Fix compile errors in Database Management view log lists by splitting `ForEach` expressions
- Extract log lists into subviews to resolve type-check timeout
- Remove unused subviews from Database Management view to keep compile times fast
- Close edit asset class sheet when save succeeds
- Add risk-adjusted performance dashboard powered by Python analytics
- Embed risk scorecard into Portfolio Overview
- Introduce interactive Asset Dashboard grouped by asset class
- Swap ZKB and Credit-Suisse references across code and docs
- Fix duplicate reference restore function to resolve compilation error

