# Changelog

All notable changes to this project will be documented in this file.

## [Unreleased]
- Add searchable, alphabetically sorted Asset SubClass picker in Add/Edit Instrument forms.
- Refine Overview update rows with inline toggle, right-aligned actions, and date filter including today
- Add Overview tab with read-only Update Reader for Portfolio Theme details
- Flesh out Portfolio Theme Overview with KPIs, filters, and update actions
- Remove obsolete feature flag checks and clean up async attachment handlers
- Introduce Link and ThemeUpdateLink tables with LinkService for theme update URLs (migration 021)
- Enable attachments for instrument updates with ThemeAssetUpdateAttachment table and shared cleanup (migration 020)
- Add AttachmentService and attachments UI for theme updates behind feature flag
- Store attachments on disk with original file extensions for Quick Look compatibility
- Introduce Attachment and ThemeUpdateAttachment tables with linking APIs for theme updates
- Expose portfolioAttachmentsEnabled setting in UI to toggle attachments
- Fix attachment type validation and update deprecated onChange handlers for macOS 14
- Introduce Instrument Notes modal with tabs for instrument updates and theme mentions
- Surface theme note mention counts and deep links from Instruments module
- Cross-link Instrument Updates from Instruments module with theme chooser and counts
- Simplify Updates in Themes section to a single Open Instrument Notes button in Edit Instrument panel
- Add Notes column to Instruments table with quick access to Instrument Notes modal
- Enable Instrument Updates entry points by default
- Enrich instrument updates with Markdown bodies, pin/unpin, and pinned-first ordering with migration 017
- Introduce PortfolioThemeAssetUpdate table and CRUD helpers for instrument-level update timelines with migration 016
- Surface Instrument Updates button and sheet in Portfolio Theme composition under feature flag
- Add search, type filter, and soft-delete with restore for Portfolio Theme updates with migration 015
- Support Markdown bodies and pinning for Portfolio Theme updates with migration 014
- Render theme update timestamps in local time and expose footer action bar with Markdown help
- Harden update logging and enforce non-null Markdown schema
- Introduce PortfolioThemeUpdate table and CRUD helpers for theme update timelines
- Log invalid theme update types, fetch themes directly for Updates view, and record author from macOS user
- Enable Updates tab and quick New Update entry points for Portfolio Themes by default
- Fix compile errors in Theme Update views and allow specifying initial tab for details modal
- Add deviation analytics with tolerance controls to Portfolio Theme valuation table
- Add description and optional institution link to Portfolio Themes with migration 012
- Align Composition table headers with data columns and add per-instrument notes pop-up in Portfolio Theme details
- Enforce consistent 2000-character limit for portfolio asset notes
- Remove Notes column from Portfolio Theme valuation table and align totals under Current Value
- Ensure Portfolio Theme valuation shows all instruments, resolves FX via identity and inversion, and keeps table visible for zero totals
- Share FXConversionService using latest flagged rates for consistent CHF conversion across views
- Log warning when FX rate_date cannot be parsed and fallback is used
- Handle valuation event serialization errors with explicit logging
- Fix Portfolio Themes list not updating Total Value after valuations load
- Add Total Value and Instruments columns with sortable headers to Portfolio Themes list
- Fix theme total value spinner by loading valuations sequentially
- Optimize portfolio theme fetch to count instruments without per-row queries
- Add on-demand Portfolio Valuation service with refreshable theme snapshot
- Include instrument notes in valuation snapshot output
- Fix valuation to aggregate instrument holdings across the entire estate
- Require archiving a theme before deletion with archive-and-delete alert flow
- Polish Portfolio Theme maintenance layouts and add instrument notes field
- Normalize empty instrument notes to nil in theme detail editor and add-instrument sheet
- Fix Portfolio Theme allocation edits not persisting and log updates
- Fix instrument notes edits not saving in theme detail view
- Present valuation status and notes in dedicated columns to avoid confusion
- Introduce PortfolioThemeAsset table linking themes to instruments with target allocations
- Add PortfolioTheme entity with CRUD UI and migration 010
- Fix Portfolio Theme creation to persist database records and improve new theme editor layout
- Remove Portfolio Themes feature flag; navigation and Theme Status settings are always visible
- Navigate from Portfolio Themes list to detail view with keyboard, icon, or context menu; archived themes open read-only
- Present Portfolio Theme details in modal window with aligned Composition and Valuation sections
- Disable Performance and Rebalancing links in sidebar
- Ensure new theme popup accepts a theme code and disable Save until required fields are valid
- Introduce HealthCheckRegistry for startup diagnostics with per-check configuration
- Expose health check summary and toggle in Settings with link to detailed report
- Show executed health checks with detailed results in dedicated window and verify database file presence
- Add SQL example for PortfolioThemeStatus color validation and require migrations to include the CHECK constraint
- Document constraints and indexes for `PortfolioThemeAsset` in portfolio module spec
- Clarify `current_value` sourcing, on-demand refresh, caching, and failure modes in Portfolio Module specification
- Document attachment limits and access controls in portfolio module spec
- Document Portfolio module endpoints with status codes, pagination, versioning, and standard error envelope
- Document migration dependencies and guidelines for Portfolio Module integration
- Update parser mapping docs to schema version 4.26 and document maintenance for future schema changes
- Cache institution name in Position form to avoid repeated lookups
- Generate docs manifest and enforce updates via CI workflow
- Add troubleshooting guide and fix README link path
- Deduplicate version history entries in README
- Consolidate UI concept notes into the main UI/UX design guide
- Replace Database Management & Backups section with link to consolidated database documentation
- Clarify PortfolioThemeStatus scope, color code validation, and default handling in portfolio module docs
- Introduce PortfolioThemeStatus table with default statuses and basic management UI
- Fix SQLITE_TRANSIENT compile error in PortfolioThemeStatus database helpers
- Wrap PortfolioThemeStatus insert/update operations in transactions and log sqlite3_exec errors to preserve default integrity
- Harden PortfolioThemeStatus update transaction to rollback on commit failure
- Surface Theme Status save failures and handle default restoration errors
- Log default restoration as info to match OSLog levels
- Add search bar to Positions view to filter positions across all fields
- Disable Generate Full Instrument Report button with hover notice in Database Management view
- Expand Backup & Restore log by default in Database Management view
- Add button to validate Instruments in Database Management view
- Temporarily disable Reference and Transaction data backup and restore buttons
- Add configurable startup health checks with UI summary
- Log individual startup health check results and ensure database file check passes by reading the path lazily
- Sync validation status of class and subclass targets from findings and purge zero-target data
- Skip validation for asset classes without target allocation and clear related findings
- Enlarge validation details modal and add close button
- Add totals row and validation details modal to Asset Allocation view
- Move portfolio total validation from class editor to main dashboard and show validation badges for asset classes
- Persist class-level validation findings and show them via "Why?" in target edit panel
- Replace faulty allocation validation triggers with non-blocking versions and update validation_status
- Convert Edit Targets panel into resizable floating window with scrollable content
- Show bold, left-aligned "Asset Allocation for <Class>" title in target edit panel
- Add validation status column with traffic-light icons and deviation bars in Asset Allocation table
- Fix failed ClassTargets/SubClassTargets upserts so edited targets persist
- Ensure backup routines include TargetChangeLog and full reference data
- Fix backup script to verify and close database before deleting corrupt backup
- Remove legacy Asset Allocation view and navigation link
- Polish target edit panel layout with fixed width and regrouped inputs for clarity
- Expand target edit panel to 800x600 and allow dragging to reposition
- Fix optional class ID handling in target sum validation warnings
- Persist parent class targets and warn on total allocation without blocking saves
- Introduce ClassTargets and SubClassTargets tables with migration logging
- Add script to reset database and import legacy data
- Fix legacy data import script to preserve new tables when loading old data
- Fix legacy import script to handle column mismatches when copying data
- Fix Edit Targets panel to preload stored target values before validation
- Fix Cancel button in Edit Targets panel to discard changes without saving
- Display sub-class target sums and log totals in Edit Targets panel
- Add segmented display mode toggle for Asset Classes tile
- Show database schema version in Database Management view and include it in backup file names
- Polish Crypto Allocations tile visuals and reduce row spacing
- Redesign Asset Allocation dashboard with modern cards
- Added persistent edit buttons & dbl-click shortcut for target rows (PR #XXX)
- Target editor pops up below row with white background and tolerance field (PR #XXX)
- Document dbmate workflow and require `008_add_backup_restore_safety.sql` in migration sequence
- Correct Credit-Suisse parser mapping docs to reference Credit-Suisse only, update schema version to 4.25, and align field mappings
- Document ZKB asset class mappings and replace placeholder codes
- Document Target Allocation edit panel workflow
- Implement side-panel editor for Asset Class targets
- Activate pencil edit button in Allocation Targets table
- Fix edit pencil visibility in Allocation Targets table and place it next to Target column
- Style pencil button for visibility and ensure it opens the edit panel
- Show pencil button next to the Target column and open the edit panel on
  double-click
- Make pencil buttons persistent with row highlight and keyboard activation
- Show both Target % and Target CHF fields in edit pop-over with automatic conversion
- Store all asset allocation targets solely in TargetAllocation table and drop obsolete column from PortfolioInstruments
- Load stored Target CHF in edit pop-over, computing from portfolio total only if missing, and allow saving with non-zero remaining
- Include all tables and SQLite metadata in full database backup and restore
- Add detailed logging and validation to Edit Targets panel
- Fix Edit Targets validation to sum all asset- and sub-class targets with detailed logging
- Load and persist target edits with dual-field mode and non-blocking validation warnings
- Pre-populate target amount fields from the database and format CHF values with
  thousands separators on blur
- Fix compile errors in Asset Allocation dashboard views
- Fix caption row overlay placement in Asset Allocation table
- Migrate width update onChange to new two-parameter closure
- Redesign overview bar layout with dedicated tiles
- Fix color scheme handling in overview bar and card components
- Convert Allocation dashboard to two-column layout with full-width overview bar
- Correct side padding and responsive columns in Asset Allocation view
- Add macOS Kanban to-do board with drag-and-drop
- Polish asset-class table layout and typography
- Refine deviation label placement in asset allocation table
- Make Asset-Class table responsive with compact CHF numbers
- Maintain equal margin around Asset-Class table to prevent bleed
- Auto-scale Asset Classes columns proportionally when the card is resized
- Optimise Asset Class tile layout and cap deviation bars in Allocation dashboard
- Add fixed delta column and abbreviated numbers in Asset Classes table
- Fix delta column layout to stay visible within Asset Classes card
- Shrink table padding and correct column widths to keep delta column visible
- Add sidebar link to the Kanban board
- Set position currency automatically from selected instrument and disable manual override
- Lock position institution to the selected account and auto-fill from account
- Reorganize sidebar navigation with expandable sections and remove old transaction links
- Combine Currencies and FX Rates maintenance into one tabbed view
- Rework Asset Classes card header with inline picker
- Combine Asset Class and SubClass management into one page with sortable rows
- Add column filters, single-column sorting and double-click editing to Instruments and Positions tables
- Display tolerance pills in Asset Allocation table rows
- Fix compile error referencing systemGray6 in tolerance pill background
- Fix compile errors referencing system gray colours and deprecated onChange API
- Provide fallback colours for systemGray4-6 on macOS to resolve compile errors
- Refine deviation bar logic in Asset Allocation view
- Update deviation bar display in Asset Allocation tile
- Shorten deviation bars to half length in Asset Allocation tile
- Remove plus/minus icons from deviation column in Asset Allocation tile
- Prompt to confirm option quantity multiplier during position import
- Show institutions ranked by AUM in new dashboard tile
- Document troubleshooting steps for missing `default.metallib` warning
- Add Asset Allocation dashboard with interactive bubble chart
- Mention language code console warnings and how to silence them
- Log database version correctly at startup
- Label green stale account range as "<1 month / today"
- Show per-table row count comparison after restore in a modal window
- Auto-expand stale account sections and open editable account detail window from Dashboard
- Add validation triggers for ClassTargets/SubClassTargets and surface warnings in allocation editor
- Bind asset allocation views to ClassTargets and SubClassTargets tables
- Allow dashboard tiles to resize adaptively with a responsive grid
- Arrange dashboard tiles in a masonry layout with half-spacing gaps vertically
- Provide Save/Cancel buttons in Account Detail window with quick saved status
- Polish Account Detail window layout with labeled fields and toolbar actions
- Resolve progress indicator layout warning on macOS
- Display all stale accounts sorted by earliest update and account name
- Delete Asset SubClass instantly with toast feedback and error alert when in use
- Display table details when Asset SubClass deletion fails
- Widen Restore Comparison window to display all columns without scrolling
- Confirm deletion of positions per account type with live count
- Display stale accounts grouped by age with collapsible sections
- Generate full instrument report from Database Management view
- Use latest flagged FX rates for import value calculations and report applied rates
- Store import session total value and add CLI summary report
- Show imported position values in CHF after import completes
- Persist full value reports per import session and view them from history
- Persist value reports in database after import and fix Session Details sheet closing
- Fix Import Values window closing when pressing the Close button
- Present value report in a table window after import
- Document production folder path and backups in README
- Compute value report from positions when stored data is missing
- Fix unused variable warning when computing position values
- Display consolidated crypto allocations with scrolling in Dashboard (#PR)
- Add Crypto Top 5 dashboard tile showing largest crypto holdings
- Populate import session value report modal with stored rows
- Improve Credit-Suisse parser instrument matching via Valor/ISIN with row-level logging of Valor and ISIN
- Log Valor and ISIN for each parsed Credit-Suisse row and store valor numbers
- Fix instrument report generation by locating script path correctly
- Display sub-class aggregate totals with delta validation in Allocation Targets table
- Fix compile error from variable name clash in AllocationTargetsTableView
- Shrink Data Import/Export panels and show square drag-and-drop area
- Add Import Session History tab with per-session totals
- Enable multi-institution selection in Positions view with summary totals and bulk delete
- Show total CHF value for selected institutions in Positions view
- Add ZKB CSV import parser and enable ZKB statements in Data Import/Export view
- Fix compile error when passing statement type to ImportManager
- Prompt to delete existing ZKB positions when importing statements
- Delete existing ZKB positions by name or BIC before import and log removed count
- Update ZKB deletion to use BIC `ZKBKCHZZ80A` and correct institution name
- Handle percent-valued bond prices in ZKB CSV import
- Convert percent-valued bond prices in Credit-Suisse XLS import
- Save cash account balances from Credit-Suisse statements into PositionReports
- Fix storing cash account balances when account or instrument lookup fails
- Log row numbers and failure reasons when processing cash account rows
- Fix cash account instrument lookup by currency code
- Sanitize ticker lookup so CASHCHF resolves correctly
- Allow selecting tables for transaction backups and restores with versioned filename
- Allow deleting PositionReports for a selected institution when importing ZKB statements
- Alert when an unknown instrument is encountered during import
- Fix ZKB CSV import assigning Equate Plus institution and zero quantities
- Fix type mismatch when selecting parser for statement import
- Robust ZKB instrument discovery using Valor, ISIN and ticker with logging
- Visualize target vs actual allocations with dual-ring donut chart and delta bar layout in Allocation Targets view
- Remove outdated Asset Allocation view and sidebar link
- Move Target Asset Allocation link to Key Features section
- Fix compile warnings for immutable variables in import processing
- Fix compile error in allocation charts by importing Charts framework
- Resolve build error by replacing onTapGesture with overlay gesture in donut chart
- Fix duplicate IDs in import summary logs to avoid SwiftUI warnings
- Avoid duplicate IDs in backup and import logs
- Fix compile error from private `chfFormatter` in ImportSessionHistoryView
- Add Import Session History link in sidebar navigation
- Show correct database version in startup log
- Fix seed data to include valor numbers in Instruments table
- Replace instrument seed data with Consolidated_Instruments_V8.xlsx for updated test dataset
- Integrate asset target allocation test dataset into schema.txt
- Expand seed dataset with full production reference data
- Expand PositionReports with diverse sample entries for testing
- Rename Direct Real Estate subclass to Own Real Estate and add ZKB bank accounts
- Add risk concentration dashboard tile showing top 5 groups by value
- Support asset class grouping and display CHF values in Risk Buckets tile
- Add valor number field to instruments with database and UI support
- Allow editing allocation targets in CHF or percent with per-row mode toggle
- Split Allocation Targets table into Target %/CHF columns with totals row warning
- Enforce minimum column widths in Positions table to prevent overlap
- Replace legacy target allocation editor with unified AllocationTargetsTableView
- Polish Allocation Targets table visuals and group styling
- Refine AllocationTargetsTableView with soft blue toggles and subclass backgrounds
- Improve Position form with labeled numeric fields and aligned date pickers
- Add Allocation Targets table view with hierarchical editing
- Fix compile error referencing children key path in AllocationTargetsTableView
- Refine Allocation Targets table layout with RAG badges
- Refine Position form typography and enforce minimum sheet size
- Refine AllocationTargetsTableView formatting and persistence
- Refine AllocationTargetsTableView editing and ordering behaviour
- Add sortable Target % and Actual % columns with default Actual % ordering in AllocationTargetsTableView
- Always show sort arrows and group zero-allocation rows at reduced opacity in AllocationTargetsTableView
- Add Asset Allocation view showing target vs actual with deviation slider and summary table
- Compute asset class totals from subclass values to show CHF amounts next to sliders
- Fix compile error in Asset Allocation view model by specifying dictionary types
- Fix crash from duplicate target records when viewing Asset Allocation
- Add toggle for Own Real Estate with CHF amount and persist settings
- Persist target allocation percentages to new TargetAllocation table
- Include FX History table in reference data backups
- Show info tooltip listing tables on Reference Data card
- Display popover listing reference tables when hovering info icon
- Fix unicode bullet escape in Data Import/Export status message causing build error
- Fix compile error displaying Reference Data tooltip
- Track last instrument update timestamp on PositionReports
- Track earliest instrument update timestamp on Accounts
- Test migrations for instrument update columns
- Add exchange_rates.sql script with sample FX rates for all currencies
- Fix transaction error in exchange_rates.sql script
- Embed FX rate sample data in schema seed file
- Auto-save allocation values on exit and simplify maintenance view UI
- Add ExchangeRates maintenance view for CRUD FX rate management
- Fix Asset SubClass creation failing due to missing class_id binding and show success alert on save
- Fix SQLITE_TRANSIENT compile error in ExchangeRates database helpers
- Fix compile error mapping active currencies in ExchangeRates view model
- Add "Accounts Needing Update" dashboard tile showing top 10 stale accounts
- Reverse stale accounts order so the oldest update appears first
- Fix ambiguous `fetchAccounts` call causing compilation failure in StaleAccountsViewModel
- Display Currency Maintenance and FX History links in sidebar
- Display instrument updated date in Positions view and form
- Fix instrument fetch tuple mismatch in PositionFormView
- Display earliest instrument updated date in Accounts view and forms
- Show total asset value in CHF on Positions view with refresh button
- Show total asset value in CHF on Dashboard via metric tile
- Display total asset value without decimals on the dashboard tile using Swiss thousands separator
- Format total asset value in Positions view using Swiss thousands separator
- Truncate decimals when displaying total asset value in Positions view
- Replace Load Documents with Data Import/Export view and statement log
- Enable file picker and drag-and-drop on Data Import/Export screen
- Unify drag-and-drop and file picker handling in Data Import/Export view
- Document Data Import/Export screen spec with Statement Loading Log and wireframe
- Redesign Data Import/Export view with import cards, summary bar and persistent log
- Display import progress and update log when importing Credit-Suisse statements
- Assign report date to instrument updated timestamp for Credit-Suisse imports
- Simplify Data Import/Export layout with separate status bar and persistent log
- Fix Data Import/Export layout so Select File button and log panel are visible
- Fix file importer losing selected statement type so imports run after choosing a file
- Fix Data Import/Export file picker not starting import after choosing a file
- Restore Switch Mode button in Database Management view to toggle environment
- Fix Select File button to start import by retaining chosen statement type until completion
- Restyle Statement Loading Log with padded white frame and remove extra spacer
- Add dedicated reference data backup and restore with grouped buttons
- Fix compile error from missing `rowCounts` helper
- Fix redeclaration of `counts` in BackupService
- Fix compile error when restoring reference data due to undefined `counts`
- Increase Data Import/Export canvas size and anchor Statement Loading Log at the page bottom
- Double Data Import/Export canvas to 1600x1200 and keep log pinned to the bottom
- Backup reference data separately via new UI button and CLI flag
- Enforce three-zone layout on Data Import/Export screen with persistent status line
- Resolve variable scoping issue in BackupService restore function
- Restore reference data from SQL or JSON with dedicated button
- Export reference tables as SQL with CREATE and INSERT statements
- Disable foreign key checks during reference restore to avoid constraint failures
- Include Instruments and Accounts in reference data backup/restore
- Sync full reference SQL dump for tests and clarify restore instructions
- Fix permission error when restoring reference data by using security-scoped access
- Replace deprecated allowedFileTypes API in Database Management view
- Fix compile error on macOS by using `.navigation` toolbar placement
- Show row counts after each backup or restore operation in the log panel
- Allow choosing a writable backup directory with defaults in Documents
- Display per-table row counts in Backup & Restore log with header
- Prompt for save location when backing up and include mode/version in filename
- Refactor Database Management screen into subviews to resolve type-check timeout
- Update test seed data with extended asset classes and institutions
- Display per-table summary counts in log panel
- Refine Data Import/Export layout with separate Import, Status and Log panels
- Fix Full Database restore button not showing file picker
- Delete position reports for any institution directly from the Positions view
- Enable manual add, edit and delete of positions with notes field
- Offer disable or delete option for accounts with dependency check
- Include all position fields in the add/edit position form
- Fix compilation errors in Positions view after CRUD refactor
- Move database info panel from Settings to Database Management view
- Fix SQLITE_TRANSIENT not found when binding position report text fields
- Redesigned Database Management screen with card layout and detailed backup log
- Allow sorting columns and wrap long text in the Positions table
- Fix compile error from type-checking the Positions table after adding sorting
- Resolve compile timeout in Positions table by extracting column views
- Use built-in table sortOrder to fix header sorting compile errors
- Fix compile errors in positions table by inlining columns and ordering arguments correctly
- Allow optional import session when saving positions and add picker placeholders
- Fix compile error in Database Management view due to missing `databaseInfoView`
- Refactor Target Allocation list with per-class mismatch warnings and color legend
- Improve Positions table with resizable columns and notes indicator
- Fix compile error in Positions table selection binding
- Fix compile error when setting table column widths
- Add Database Management screen with backup and restore options
- Show database metadata and allow switching between production and test modes
- Fix table column width helper that broke compilation
- Fix compile error when exceeding the column limit in the positions table
- Reduce positions table to 10 columns so SwiftUI compiles
- Fix type inference issue in Positions table column closures
- Reset sub-class targets to zero when their class target is set to zero
- Fix build issue in Target Allocation view by breaking out subviews
- Resolve compile timeout in Target Allocation view by splitting left pane
- Fix compile error referencing missing AssetSubClassData type
- Correct portfolio target SQL queries to use instrument-based columns
- Added GPT shell with OpenAI function calling and JSON schema validation
- Remove duplicate Python package initializer to resolve Xcode resource error
- Extend institution seed data with contact info and default currencies
- Delete existing Credit-Suisse position reports for all Credit-Suisse accounts before importing new positions
- Replace `account_id` with `institution_id` in `ImportSessions` table
- Add CLI flags for db_tool to run phases non-interactively
- Fix incorrect parameter label when starting import sessions
- Store import sessions by institution and value date, tracking duplicate rows
- Restyle Currency Maintenance window and update title to "Currency Maintenance"
- Log mapped Asset-Unterkategorie values to AssetSubClass during Credit-Suisse import
- Populate sub-class allocation sheet with editable sliders and totals check
- Display sub-class rows correctly and allow saving with totals other than 100%
- Fix deprecated onChange warning in Target Allocation view
- Fix deprecated onChange warning in Risk Scorecard view
- Fix deprecated onChange warning in Asset Allocation view
- Persist portfolio class and sub-class targets using dictionaries
- Refactor target allocation view to edit sub-class targets inline with DisclosureGroups
- Add asset allocation variance heatmap tile to dashboard
- Fix overlapping labels and gesture issues in allocation heatmap
- Allow editing Asset Class in Asset SubClass popup
- Create cash accounts during position import and record deposits
- Extend Institutions with contact info, currency and country fields
- Add Target Allocation maintenance screen for editing portfolio targets
- Fix compile error in Target Allocation maintenance view
- Expand target allocation screen with dynamic class and sub-class editing
- Improve target allocation editor with modal sub-class panel and slider tweaks
- Fix build errors from ForEach bindings in target allocation view
- Refactor Target Allocation maintenance view to avoid type-checking timeouts
- Fix deprecated isoRegionCodes warning in Institutions view
- Add sample institutions dataset for testing
- Replace Institutions seed data with new dataset
- Rename cash account names using institution and currency codes
- Restyled Institutions maintenance window for consistent look and feel
- Retry account prompt until a account is created during position import
- Fix compile error in Institutions view due to missing empty state component
- Added Asset Class maintenance screens with create, update and delete
- Fix compile errors in Asset Class maintenance view on macOS
- Modernize Asset Class add/edit windows with standard design and logging
- Modernize Asset Class list view with search, animations and action bar
- Fix missing modernStatCard helper in Asset Classes view
- Add Credit-Suisse position import with progress logging and summary alert
- Fix quantity extraction for Credit-Suisse position import and document Excel column mapping
- Parse ticker symbol from Valor and build instrument names including institution and currency
- Default quantity to zero for "Credit-Suisse Call Account USD" when cell is blank
- Prompt for instrument details when new securities are imported
- Automatically create Credit-Suisse accounts when missing and save position reports
- Fix unused variable warning when auto-creating Credit-Suisse cash accounts
- Exclude cash instruments from performance and allocation views
- Fix missing instrument popup and save newly added instruments
- Fix instrument lookup to prompt when new securities are parsed
- Review each parsed position with editable popup before saving and fix layout constraints
- Provide instrument add dialog with Save/Ignore/Abort when new ISINs are encountered
- Restyle import popups using instrument maintenance window design
- Fix compile errors in position review and import views
- Prompt to delete existing Credit-Suisse positions before importing and show count
- Parse value date from Credit-Suisse sheets, show import details summary and improve instrument popups
- Correct account number detection from cell B6 and extend new instrument prompt with dropdowns
- Fix compile error in instrument prompt view when selecting subclass or currency
- Record Credit-Suisse import sessions and link position reports
- Eliminate QoS warnings by presenting modals synchronously
- Condense instrument popups and rename review dialog title
- Show import summary in modern styled popup
- Condense import details popup row spacing
- Default positions to "Credit-Suisse account" name
- Fix saving position reports when no import session is created
- Map Credit-Suisse categories to AssetSubClasses using documented table and treat cash
  rows as accounts instead of instruments
- Fix sub-class mapping using the defined Credit-Suisse keywords
- Search existing instruments by ticker symbol before prompting
- Use single account for all parsed positions
- Display a status alert after each position save attempt
- Allow reimporting the same file by removing unique constraint on file hash
- Prompt to create new accounts when account number is missing and retry if insertion fails
- Fix compile errors in AccountPromptView due to incorrect parameter labels
- Improve account lookup when importing positions to match numbers with spaces
  and require account name containing "Credit-Suisse" to prevent repeated prompts
- Append numbers to import session names when duplicates exist
- Fallback to account lookup by number only to use existing Credit-Suisse account
- Fix account lookup to ignore non-breaking spaces in numbers
- Retry import session creation when file_hash is unique in older databases
- Improve account search by ignoring hyphens and case
- Restrict Credit-Suisse position deletions to accounts linked to the Credit-Suisse institution
- Add Credit-Suisse institution to seed data script for tests
- Add debug logs for account lookups to help diagnose duplicates
- Strip all non-alphanumeric characters when searching account numbers so the Credit-Suisse account is detected
- Clarify that `Instruments.isin` is optional rather than mandatory
- Add Credit-Suisse Test Account with sample position reports to seed data
- Look up instruments by ISIN ignoring spaces and case so existing records are detected
- Store institution_id from the linked account when saving PositionReports and prompt before removing existing Credit-Suisse positions
- Track purchase and current price in PositionReports when importing Credit-Suisse files
- Display institution name in Positions view
- Fix Positions view table headers for quantity and price columns
- Remove OLD-BANK-007 from seed data and rename Credit-Suisse test account
- Populate purchase and current price in seed position reports
- Fix argument order when constructing PositionReportData to resolve compile error
- Enlarge the import details popup so all information is visible
- Delete Credit-Suisse position reports using institution_id so all matching entries are removed
- Use IN query when deleting by institution so duplicates with the same name are fully removed
- Ensure seed PositionReports contain only one entry per account and instrument
- Remove Credit-Suisse position reports even when old rows lack an institution_id by joining through Accounts
- Bind deletion query parameters correctly so Credit-Suisse records are removed
- Delete Credit-Suisse positions by institution_id with a single query for reliability
- Delete Credit-Suisse positions by building a dynamic IN clause for all matching institution IDs and log the IDs removed
- Automatically start Credit-Suisse position import when a file is chosen without asking to delete existing rows
- Condense import popups, enlarge windows and use smaller fonts for better readability
- Guess asset sub-class from statement categories when adding new instruments
- Fix asset sub-class dropdown defaulting to Cash when prompting for new instruments
- Document asset class concept version 2.1 with Credit-Suisse mapping
- Reduce vertical spacing in import dialogs so all fields fit without scrolling
- Display instrument currency in Positions view
- Toggle parsing checkpoints to suppress import popups and show inline summary
- Make import summary panel scrollable and arrange import view in two columns
- Fix compile errors in Target Allocation maintenance view on macOS by removing
  number-pad keyboard modifier
- Delete existing files in target directory before deploying database
- Stop DragonShield and Xcode when running the database tool
- Fix initialization of database path when detecting the active mode
- Break out Database Management view subcomponents to resolve compile timeout
- Fix compile errors in Database Management view log lists by splitting `ForEach` expressions
- Extract log lists into subviews to resolve type-check timeout
- Remove unused subviews from Database Management view to keep compile times fast
- Close edit asset class sheet when save succeeds
- Add risk-adjusted performance dashboard powered by Python analytics
- Embed risk scorecard into Portfolio Overview
- Introduce interactive Asset Dashboard grouped by asset class
- Swap ZKB and Credit-Suisse references across code and docs
- Fix duplicate reference restore function to resolve compilation error
- Fix missing SQLITE_TRANSIENT constant in reference data backup

- Replace "Custody Accounts" wording with "Accounts" across the app and docs
- Fix nested transaction error during reference data restore
- Fix missing `rowCounts` call in BackupService causing compilation failure
- Fix compile error in Database Management view due to missing `value:` label
- Add manual Refresh Instrument Timestamps button to recalculate earliest instrument dates
- Introduce configurable dashboard with tile picker and persistent layout
- Fix dashboard compilation errors by renaming MetricTile and using `any` keyword
- Fix build warnings for dashboard onChange and unused variable
- Resolve Swift compiler crash in TilePickerView by refactoring TileRegistry
- Enlarge dashboard tile picker window and add "OK" button to close
- Remove Asset Dashboard view in favor of Portfolio Overview
- Display position value columns in original currency and CHF on Positions screen
- Show Top 10 Positions by Asset Value (CHF) on Dashboard
- Add Portfolio by Currency dashboard tile with CHF-based exposure
- Allow hiding and showing columns in Positions table with persistent settings
- Add adjustable font size (7-14pt) for Positions table in column settings
- Resolve compile warnings in PositionsView and ExchangeRates helpers
- Rename "Instrument Updated" label to "Last Update" in Position form
- Remove obsolete Value Date field from Position form
- Refine Asset Allocation rows with uniform bars and vibrant deviation colors
- Increase slider marker size and align allocation bars to the right edge
- Resolve onChange deprecation warning in AllocationTargetsTableView
- Document requirements for Allocation Targets table sorting indicators and zero allocation grouping
- Document Delta % column sorting and revised zero allocation criteria in Allocation Targets spec
- Clarify macOS Table API assumptions and detail zero-allocation row handling in Allocation Targets spec
- Validate AssetSubClass target sums and highlight mismatches in AllocationTargetsTableView
- Persist AssetSubClass target edits immediately
- Display AssetSubClass actual values and calculate targets relative to parent classes
- Fix crash when closing Asset Class due to stale index paths in AllocationTargetsTableView
- Group Allocation Targets table into Active and Inactive sections with orange highlight for subclass-only activity
- Show amber background instead of red when only subclasses have targets
- Fix compile errors in AllocationTargetsTableView for totals visibility and system gray color
- Fix compile error referencing NSColor.systemGray6 by using cross-platform fieldGray color
- Organize Target Asset Allocation view into collapsible sections with status details
- Resolve Swift compile errors from invalid Unicode escapes in AllocationTargetsTableView
- Pin Allocation Targets table at top with collapsible error and chart sections
- Fix unmatched braces causing compile errors in AllocationTargetsTableView
- Simplify row background colors so valid rows are white
- Add script to export Instruments table to XLSX
- Include TargetAllocation and ExchangeRates tables in transaction backup/restore
- Fix account lookup by valor when importing cash account balances with detailed logging
- Remove ZKB position deletion prompt from Data Import/Export view; use Positions view for deletions
- Add Python script for full database backup and restore using SQLite
- Improve BackupService restore logic with atomic replace and integrity validation
- Fix compile error when calling FileManager.replaceItem during database restore
- Fix integrity check failure when validating WAL-mode backups
- Preserve backup file during restore and log pre/post row comparisons
- Show detailed Backup Summary and ensure restore logs publish on main thread
- Keep original backup file by copying to a temporary location before atomic replace
- Document python backup_restore script in README
- Replace schema.sql references with dbmate migration instructions in README
- Close SQLite connection before file moves and update dbVersion on main thread
- Ensure published properties update on main thread and migrate onChange syntax
- Distinct colors for each risk bucket segment and matching legend
- Quick refresh icon on Accounts Needing Update dashboard tile
- Place Actions column first in Positions table for quicker edits

- Sort instrument Type and Currency filter menus alphabetically
- Replace blue Top 10 Positions tile with modern white card showing all positions
- Reduce list row spacing in Top Positions card for denser display
- Refine Asset Class card with captioned display toggle and color-coded deviation bars
- Tweak Asset Allocation rows with caption header and uniform deviation bars
- Enhance deviation column with centre line, delta numbers and action icons
- Add target_kind and tolerance_percent columns to TargetAllocation table
- Indicate stored target_kind with a bullet when display mode matches
- Overhaul target edit panel: modal pop-over with class and subclass sections
